on_actions = {
	on_startup = {
		effect = {
            GRE = {  
                USA = {
                    set_variable = { favor@PREV = 5 }
                }
                GER = {
                    set_variable = { favor@PREV = 5 }
                }
                JAP = {
                    set_variable = { favor@PREV = 5 }
                }
                ENG = {
                    set_variable = { favor@PREV = 5 }
                }
                FRA = {
                    set_variable = { favor@PREV = 5 }
                }
                ITA = {
                    set_variable = { favor@PREV = -22 }
                }
                CHI = {
                    set_variable = { favor@PREV = 0 }
                }
                IRQ = {
                    set_variable = { favor@PREV = 0 }
                }
                SAU = {
                    set_variable = { favor@PREV = 0 }
                }
                VEN = {
                    set_variable = { favor@PREV = 0 }
                }
                SOV = {
                    set_variable = { favor@PREV = -2 }
                }
                SPR = {
                    set_variable = { favor@PREV = 0 }
                }
                ROM = {
                    set_variable = { favor@PREV = 5 }
                }
                BUL = {
                    set_variable = { favor@PREV = -24 }
                }                    
                YUG = {
                    set_variable = { favor@PREV = 5 }
                }
            }
		}
	}

	on_startup = {
		effect = {
			GRE = {
				# You can put this in the country's history file alternatively too.
				faction_gui_initial = yes
			}
		}
	}

    on_startup = {
        effect = {
            add_to_array = {
                array = global.favor_mechanic
                value = USA.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = GER.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = ITA.id 
            }
            add_to_array = {
                array = global.favor_mechanic
                value = JAP.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = ENG.id 
            }
            add_to_array = {
                array = global.favor_mechanic
                value = SOV.id 
            }
            add_to_array = {
                array = global.favor_mechanic
                value = FRA.id 
            } 
            add_to_array = {
                array = global.favor_mechanic
                value = VEN.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = SPR.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = CHI.id 
            }
            add_to_array = {
                array = global.favor_mechanic
                value = BUL.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = YUG.id 
            }            
            add_to_array = {
                array = global.favor_mechanic
                value = ROM.id 
            }    
            add_to_array = {
                array = global.favor_mechanic
                value = TUR.id 
            } 
            add_to_array = {
                array = global.favor_mechanic
                value = IRQ.id 
            }    
            add_to_array = {
                array = global.favor_mechanic
                value = SAU.id 
            }             
        }
    }
    
    ###THIS CHECKS FOR FORTIFICATIONS ON ALBANIA BORDER###
    
    on_monthly_GRE = { 
        effect = {
            if = {
                limit = {
                    ITA = { 
                        has_country_leader = {                                              ### Make sure the Italians have Mussolini as leader (not ahistorical).
                            name = "Benito Mussolini" 
                            ruling_only = yes
                        }
                        is_puppet = no                                                      ### Make sure they are not a puppet.
                    }
                    NOT = { has_country_flag = GRE_stop_checking_fortifications }           ### This flag is set only when THIS event is triggered (so it doesn't repeat).
                    NOT = { has_country_flag = GRE_safe_from_italian_immediate_action }     ### This flag is set through various manners. E.g. exoteriki politiki decisions.
                    184 = {
                        any_province_building_level = {
                            province = {
                                id = 9805
                                id = 3914
                                id = 841
                            }
                            building = bunker
                            level > 0
                        }
                    }
                }
                set_country_flag = GRE_stop_checking_fortifications
                country_event = { id = hellenic_news.6 days = 0 }
                if = {
                    limit = { ITA = { is_in_faction = no } }
                    ITA = { 
                        create_faction = "Novus Imperium Romanum"                           ### Force Italy into a faction and make Albania their puppet.
                        add_to_faction = ALB
                        ITA = { puppet = ALB }
                    }
                }
                else = {
                    ITA = {                                                                 ### If Italy is in a faction, add Albania to it and make them their puppet.
                        add_to_faction = ALB
                        ITA = { puppet = ALB }
                    }                
                }
				ITA = {                                                                     ### Give Italy wargoal for 30 days.
					create_wargoal = {
						type = puppet_wargoal_focus 
						target = GRE
                        expire = 30
					}
				}                
            }
        }
    }

    ###This checks for amount of factories certain focuses will grant####

    on_weekly_GRE = {
        effect = {
            if = {                                                                                          ### Here we check how many factories the "Bedrock of..." focus grants 
                limit = { 
                    NOT = { has_completed_focus = GRE_bedrock_of_balkan_financial_stability }
                    has_completed_focus = GRE_a_game_of_shadows
                }
                GRE_bedrock_check = yes
            }
            if = {                                                                                          ### Here we check how many factories the "Open Foreign..." focus grants
                limit = { 
                    NOT = { has_completed_focus = GRE_open_foreign_subsidized_factories }                   
                    has_completed_focus = GRE_a_game_of_shadows
                }
                GRE_subsidized_check = yes
            }
            if = {                                                                                          ### Here we check how many factories the "Mobilise Economy..." focus grants
                limit = { 
                    NOT = { has_completed_focus = GRE_mobilise_our_economy }                                
                    has_completed_focus = GRE_a_game_of_shadows
                }
                GRE_mobilized_check = yes
            }
        }
    }
    
    ######################################################
    
    on_monthly_GRE = {
        effect = {
            every_country = {                                                                               ### Here we add or subtract favor points depending on the country's opinion of GRE 
                limit = {
                    is_in_array = {
                        array = global.favor_mechanic
                        value = THIS.id
                    }
                }
                if = {
                    limit = {
                        has_opinion = { target = GRE value > 79 }  
                    }
                    GRE_favor_80 = yes
                }
                else_if = {
                    limit = {
                        has_opinion = { target = GRE value > 39 }  
                    }
                    GRE_favor_40 = yes
                }
                else_if = {
                    limit = {
                        has_opinion = { target = GRE value > -11 }  
                    }
                    GRE_favor_0 = yes
                }
                else_if = {
                    limit = {
                        has_opinion = { target = GRE value < -10 }  
                    }
                    GRE_favor_minus = yes
                }
                GRE_clamp_favor = yes                                                                       ### Clamps the values between [-80,100]
            }
        }
    }

	on_war_relation_added = {                                                                               ### This is when Bulgaria declares war on Greece and vice versa
		effect = {
			if = {
				limit = {
                    OR = {
                        tag = BUL
                        tag = GRE
                    }
					FROM = { 
                        OR = {
                            tag = GRE
                            tag = BUL
                        }
					}
				}
				GRE_line_pop = yes
			}           
        }
    }
    
    #################################################################################################################################################################################################################
    #################################################################[                                                                                         ]#####################################################
    #################################################################[                            GRECO ITALIAN WAR SCRIPTED EFFECTS                           ]#####################################################
    #################################################################[                                                                                         ]#####################################################
    #################################################################################################################################################################################################################
    
	on_war_relation_added = {                                                                               ### This is when Italy declares war on Greece ( on extreme cases vice-versa )
		effect = {
			if = {
				limit = {
                    tag = ITA
					FROM = { 
                        tag = GRE
					}
				}
                ##########################################[Greek Effects]##########################################
                GRE = {
                    set_global_flag = GRE_grecoitalian_start
                    if = {                                                                                  ### Basically make sure the mission of holding the lane only activates if the Italians enact a border war (other case is Greece provoked them so they won't have claimed an easy victory as they did historically
                        limit = {
                            ITA = { is_neighbor_of = GRE }
                        }
                        activate_mission = GRE_stabilize_the_line
                    }
                    if = {
                        limit = {
                            NOT = { has_completed_focus = GRE_rearmament }
                        }
                        set_variable = { GRE_metaxas_army_prepared_level = 1 }
                    }
                    else_if = {
                        limit = {
                            check_variable = { var = GRE_army_reform_cnt value = 5 compare = less_than }
                        }
                        set_variable = { GRE_metaxas_army_prepared_level = 2 }
                        complete_national_focus = GRE_ochi
                    }
                    else_if = {
                        limit = {
                            check_variable = { var = GRE_army_reform_cnt value = 5 compare = greater_than_or_equals }
                            check_variable = { var = GRE_army_reform_cnt value = 10 compare = less_than }
                        }
                        set_variable = { GRE_metaxas_army_prepared_level = 3 }
                        if = {
                            limit = {
                                NOT = { has_country_flag = GRE_metaxas_army_mobilized }
                            }
                            activate_decision = army_buffs
                        }
                        complete_national_focus = GRE_ochi
                        complete_national_focus = GRE_hellenic_passion
                        complete_national_focus = GRE_entrenching
                    }
                    else_if = {
                        limit = {
                            check_variable = { var = GRE_army_reform_cnt value = 10 compare = greater_than_or_equals }
                        }
                        set_variable = { GRE_metaxas_army_prepared_level = 4 }
                        if = {
                            limit = {
                                NOT = { has_country_flag = GRE_metaxas_army_mobilized }
                            }
                            activate_decision = army_buffs
                        }
                        complete_national_focus = GRE_ochi
                        complete_national_focus = GRE_hellenic_passion
                        complete_national_focus = GRE_stabilizing_the_line
                        complete_national_focus = GRE_entrenching
                        complete_national_focus = GRE_population_sacrifice
                        complete_national_focus = GRE_army_organized
                    }
                }
                ##########################################[Italian Effects]##########################################
                if = {
                    limit = {
                        GRE = { NOT = { is_in_faction_with = ENG } }
                        YUG = { 
                            NOT = { is_in_faction_with = GER }
                            NOT = { has_war_with = GER }
                            NOT = { has_war_with = ITA }
                            NOT = { has_capitulated = yes }
                            exists = yes     
                        }
                        BUL = {
                            #NOT = { is_in_faction_with = GER }
                            NOT = { has_war_with = GRE }
                        }
                    }
                    ITA = {
                        add_ideas = GRE_italian_ambition                                                                        ### Basically stops the Italians from calling any allies to the war (historical). To make the player also wanna do the same, if Italy doesn't call anyone and wins the war, then the entirety of Greece will fall under her control.
                    }
                }
                ##########################################[Bulgarian Effects]##########################################
                if = {
                    limit = {
                        check_variable = { var = TUR.favor@GRE value = 50 compare = less_than }                                 ### Historically, Mussolini invited the Bulgarians to attack with him, offering some of their claimed land back, however, they could not do so as a)they were not ready yet, b) Turkey threatened Bulgaria to intervene if they intervened so they had to wait out the Germans. 
                        NOT = { has_country_flag = GRE_balkan_pact_members_rallied_against_bulgarians }                         ### Here Bulgarians are stopped by the Turks if the Greece has sufficient influence over them and went through the exoteriki politiki path.
                        NOT = { has_country_flag = GRE_requested_axis_support_over_the_bulgarian_matter }                       ### Here we have an alternative choice where the player chose to court the Axis over limiting the Bulgarians
                        BUL = { 
                            exists = yes 
                            is_puppet = no
                            is_subject = no
                        }
                    }
                    BUL = {                                                                                                     ### If Greece has done nothing to counter the Bulgarian threat, either take them on, enact diplomatic ties with Balkan pact members or even ask the Axis to keep them out of the ring, then
                        declare_war_on = {                                                                                      ### Bulgaria accepts Italy's offer and declares war on Greece
                            target = GRE
                            type = take_state_focus
                            generator = { 731 184 }
                        }                        
                        add_ideas = GRE_bulgarian_ambition
                        # GRE = { country_event = { id = hellas.x days = 0 } }                                                  ### Greece gains event informing them of Italian-Bulgarian plans
                    }
                }
                ##########################################[Allies Effects]############################################
                ##########################################[German Effects]############################################
                ##########################################[Yugoslavian Effects]#######################################
                ##########################################[Turkish Effects]###########################################
                ##########################################[Romanian Effects]##########################################
			}           
        }
    } 


    
    on_join_faction = {                                                                                     ### If Greece joins the Allies, then the Germans (and the rest of the Axis) will be able to join the war.
        effect = {
            if = {
				limit = {
                    original_tag = GRE
                    has_global_flag = GRE_grecoitalian_start
                    FROM = {
                        original_tag = ENG
                    }
				}
                ITA = {
                    remove_ideas = GRE_italian_ambition
                }
            }
        }   
    }
    
    on_war_relation_added = {                                                                               ### This is when Germany/Italy declares war on Yugoslavia.
		effect = {
			if = {
				limit = {
                    OR = {
                        tag = ITA
                        tag = GER
                    }
					FROM = { 
                        tag = YUG
					}
				}
                ITA = {
                    remove_ideas = GRE_italian_ambition
                }
			}           
        }
    }
}